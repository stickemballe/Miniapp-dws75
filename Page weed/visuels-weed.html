<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Visuels Weed — Menu</title>
<style>
  /* --- ✨ IMPORTATION DE VOTRE POLICE PERSONNALISÉE --- */
  @font-face {
    font-family: 'Bomber Escort Condensed';
    src: url('https://file.garden/aIhdnTgFPho75N46/bomberescortcond.ttf');
    font-weight: normal;
    font-style: normal;
    font-display: swap;
  }

  /* Variables utiles */
  :root {
    /* Hauteur visible du fond pendant l'effet sticky (peut être ajustée) */
    --bg-height: 130vh;
  }

  /* ----- STRUCTURE STICKY CORRIGÉE -----
     Principe: .sticky-background reste sticky sur --bg-height.
     La hauteur de .sticky-wrapper est calculée en JS = bgHeight + (contentHeight - vh max 0).
     Ainsi: 1) les images et le fond démarrent EN MÊME TEMPS,
            2) arrivé en bas du fond, il s'arrête exactement quand la dernière carte arrive en bas de l'écran,
            3) on ne peut plus pousser les images au-delà du bas du fond => pas de "trou" blanc.
  */
  #visual-menu-page { isolation: isolate; }

  #visual-menu-page .sticky-wrapper {
    position: relative;
    height: var(--wrapper-height, 200vh); /* sera ajusté par JS */
  }

  #visual-menu-page .sticky-background {
    position: sticky;
    top: 0;
    z-index: 1;
    height: var(--bg-height);
    width: 100%;
    background-image: url('https://file.garden/aIhdnTgFPho75N46/weed2.jpg');
    background-size: cover;
    background-position: center;
    will-change: transform; /* perf */
  }

  /* Le contenu est AU-DESSUS du fond sticky et commence superposé */
  #visual-menu-page .content-on-top {
    position: relative;
    z-index: 2;
    margin-top: calc(-1 * var(--bg-height)); /* superpose les boutons sur l’image */
    padding-top: 8vh; /* petit respir */
  }

  /* Grille de cartes */
  #visual-menu-page .btn-image-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: flex-start;
    gap: 25px;
    padding: 40px 20px 60px 20px;
  }

  /* --- STYLE PERCUTANT POUR LES TITRES AVEC VOTRE POLICE --- */
  #visual-menu-page .section-title-text {
    width: 100%;
    text-align: center;
    font-family: 'Bomber Escort Condensed', 'Roboto', sans-serif;
    font-size: 32px;
    font-weight: bold;
    color: #fff;
    text-transform: lowercase;
    margin: 20px 0 15px 0;
    text-shadow: 0 0 8px rgba(41, 236, 55, 0.6), 0 0 12px rgba(0, 0, 0, 0.8);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    opacity: 0;
    transform: scale(0.95);
  }
  #visual-menu-page .btn-image-container > .section-title-text:first-child {
    margin-top: 0;
  }
  #visual-menu-page .section-title-text img.flag-icon {
    width: 32px;
    height: 24px;
    object-fit: cover;
    border-radius: 4px;
    box-shadow: 0 0 5px rgba(0,0,0,0.5);
  }

  #visual-menu-page .btn-image-link {
    display: block;
    position: relative;
    width: 250px;
    height: 250px;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
    transform: scale(0.95);
    opacity: 0;
    background: #0b0b0b; /* évite flash blanc si image tarde */
  }
  #visual-menu-page .btn-image-link:active { transform: scale(0.92); }
  #visual-menu-page .btn-image { width: 100%; height: 100%; object-fit: cover; display:block; }

  #visual-menu-page .origin-badge {
    position: absolute;
    top: 15px; left: 15px;
    background: linear-gradient(to right, rgba(20, 20, 20, 0.8), rgba(40, 40, 40, 0.7));
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    border-radius: 25px;
    padding: 6px 10px;
    display: flex;
    align-items: center;
    gap: 6px;
    z-index: 10;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  #visual-menu-page .origin-badge img.flag-icon {
    width: 26px; height: 19px; object-fit: cover; border-radius: 4px;
  }

  @media (max-width: 768px) {
    #visual-menu-page .btn-image-link { width: 80vw; height: 80vw; }
    #visual-menu-page .section-title-text { font-size: 24px; }
  }
</style>
</head>
<body>
<div id="visual-menu-page">
  <div class="sticky-wrapper">
    <div class="sticky-background"></div>

    <!-- IMPORTANT: le contenu est maintenant *dans* le wrapper pour contrôler correctement la fin du sticky -->
    <div class="content-on-top">
      <div class="btn-image-container">
        <!-- SECTION 1 -->
        <div class="section-title-text">
          <img class="flag-icon" src="https://flagcdn.com/w40/es.png" alt="Drapeau Espagne">
          <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          <span>CALI ESPAGNOLE</span>
          <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          <img class="flag-icon" src="https://flagcdn.com/w40/es.png" alt="Drapeau Espagne">
        </div>

        <a href="/usa-spain-product-page" class="btn-image-link">
          <div class="origin-badge">
            <img class="flag-icon" src="https://flagcdn.com/w40/es.png" alt="Drapeau Espagne">
            <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          </div>
          <img class="btn-image" src="https://file.garden/aIhdnTgFPho75N46/wedding-cake-spain2.png" alt="Weed USA-Spain">
        </a>

        <!-- SECTION 2 -->
        <div class="section-title-text">
          <img class="flag-icon" src="https://flagcdn.com/w40/ca.png" alt="Drapeau Canada">
          <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          <span>CALI CANADIENNE</span>
          <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          <img class="flag-icon" src="https://flagcdn.com/w40/ca.png" alt="Drapeau Canada">
        </div>

        <a href="/usa-canada-product-page-1" class="btn-image-link">
          <div class="origin-badge">
            <img class="flag-icon" src="https://flagcdn.com/w40/ca.png" alt="Drapeau Canada">
            <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          </div>
          <img class="btn-image" src="https://file.garden/aIhdnTgFPho75N46/gelato2.png" alt="Weed USA-Canada 1">
        </a>

        <a href="/usa-canada-product-page-2" class="btn-image-link">
          <div class="origin-badge">
            <img class="flag-icon" src="https://flagcdn.com/w40/ca.png" alt="Drapeau Canada">
            <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          </div>
          <img class="btn-image" src="https://file.garden/aIhdnTgFPho75N46/cherry-pie2.png" alt="Weed USA-Canada 2">
        </a>

        <a href="/usa-canada-product-page-3" class="btn-image-link">
          <div class="origin-badge">
            <img class="flag-icon" src="https://flagcdn.com/w40/ca.png" alt="Drapeau Canada">
            <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          </div>
          <img class="btn-image" src="https://file.garden/aIhdnTgFPho75N46/blackcherry2.png" alt="Weed USA-Canada 3">
        </a>

        <a href="/usa-canada-product-page-4" class="btn-image-link">
          <div class="origin-badge">
            <img class="flag-icon" src="https://flagcdn.com/w40/ca.png" alt="Drapeau Canada">
            <img class="flag-icon" src="https://flagcdn.com/w40/us.png" alt="Drapeau USA">
          </div>
          <img class="btn-image" src="https://file.garden/aIhdnTgFPho75N46/wedding-cake-canada2.png" alt="Weed USA-Canada 4">
        </a>

      </div>
    </div>
  </div>
</div>

<script>
(function() {
  function pxFromVh(vh) { return window.innerHeight * (vh / 100); }

  function computeWrapperHeight() {
    const root = document.documentElement;
    const page = document.querySelector('#visual-menu-page');
    if (!page) return;

    const wrapper = page.querySelector('.sticky-wrapper');
    const content = page.querySelector('.content-on-top');

    // Récupère --bg-height (vh, px, etc.). On supporte vh et px.
    const raw = getComputedStyle(root).getPropertyValue('--bg-height').trim();
    let bgPx = 0;
    if (raw.endsWith('vh')) bgPx = pxFromVh(parseFloat(raw));
    else if (raw.endsWith('px')) bgPx = parseFloat(raw);
    else {
      // valeur sans unité => on assume vh
      bgPx = pxFromVh(parseFloat(raw));
    }

    // Mesure du contenu (il est déjà superposé au fond au départ)
    const contentRect = content.getBoundingClientRect();
    const contentHeight = contentRect.height;

    // Distance de défilement nécessaire pour amener le bas du contenu au bas du viewport
    const extraScroll = Math.max(0, contentHeight - window.innerHeight);
    const wrapperHeight = Math.ceil(bgPx + extraScroll);

    wrapper.style.setProperty('--wrapper-height', wrapperHeight + 'px');
    wrapper.style.height = wrapperHeight + 'px';
  }

  function debounce(fn, t) {
    let id; return function(){ clearTimeout(id); id = setTimeout(fn, t||100); };
  }

  document.addEventListener('DOMContentLoaded', function() {
    computeWrapperHeight();

    // Apparition en cascade des éléments
    const pageWrapper = document.querySelector('#visual-menu-page');
    if (pageWrapper) {
      const animatedElements = pageWrapper.querySelectorAll('.btn-image-link, .section-title-text');
      animatedElements.forEach((el, i) => {
        setTimeout(() => {
          el.style.transition = 'opacity 0.6s ease, transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55)';
          el.style.opacity = '1';
          el.style.transform = 'scale(1)';
        }, i * 150);
      });
    }
  });

  window.addEventListener('load', computeWrapperHeight); // images chargées
  window.addEventListener('resize', debounce(computeWrapperHeight, 150));
})();
</script>
</body>
</html>